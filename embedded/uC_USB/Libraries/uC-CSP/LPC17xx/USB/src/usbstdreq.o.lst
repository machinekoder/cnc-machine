   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"usbstdreq.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.bss
  19              	bConfiguration:
  20 0000 00       		.space	1
  21 0001 000000   		.align	2
  22              	pfnHandleCustomReq:
  23 0004 00000000 		.space	4
  24              		.align	2
  25              	pabDescrip:
  26 0008 00000000 		.space	4
  27              		.text
  28              		.align	2
  29              		.global	USBRegisterDescriptors
  30              		.thumb
  31              		.thumb_func
  33              	USBRegisterDescriptors:
  34              	.LFB0:
  35              		.file 1 "Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c"
   1:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /*
   2:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	LPCUSB, an USB device driver for LPC microcontrollers
   3:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Copyright (C) 2006 Bertrik Sikken (bertrik@sikken.nl)
   4:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
   5:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Redistribution and use in source and binary forms, with or without
   6:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	modification, are permitted provided that the following conditions are met:
   7:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
   8:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	1. Redistributions of source code must retain the above copyright
   9:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	   notice, this list of conditions and the following disclaimer.
  10:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	2. Redistributions in binary form must reproduce the above copyright
  11:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	   notice, this list of conditions and the following disclaimer in the
  12:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	   documentation and/or other materials provided with the distribution.
  13:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	3. The name of the author may not be used to endorse or promote products
  14:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	   derived from this software without specific prior written permission.
  15:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  16:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
  17:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
  18:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
  19:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
  20:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
  21:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  22:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  23:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  24:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  25:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  26:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** */
  27:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  28:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  29:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /** @file
  30:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Standard request handler.
  31:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  32:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	This modules handles the 'chapter 9' processing, specifically the
  33:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	standard device requests in table 9-3 from the universal serial bus
  34:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	specification revision 2.0
  35:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  36:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Specific types of devices may specify additional requests (for example
  37:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	HID devices add a GET_DESCRIPTOR request for interfaces), but they
  38:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	will not be part of this module.
  39:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  40:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@todo some requests have to return a request error if device not configured:
  41:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@todo GET_INTERFACE, GET_STATUS, SET_INTERFACE, SYNCH_FRAME
  42:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@todo this applies to the following if endpoint != 0:
  43:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@todo SET_FEATURE, GET_FEATURE
  44:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** */
  45:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  46:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #include <lpc_types.h>
  47:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  48:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #include <usbdebug.h>
  49:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #include <usbstruct.h>
  50:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #include <usbapi.h>
  51:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  52:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #include <stddef.h>
  53:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  54:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define MAX_DESC_HANDLERS	4		/**< device, interface, endpoint, other */
  55:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  56:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  57:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /* general descriptor field offsets */
  58:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define DESC_bLength					0	/**< length offset */
  59:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define DESC_bDescriptorType			1	/**< descriptor type offset */
  60:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  61:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /* config descriptor field offsets */
  62:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define CONF_DESC_wTotalLength			2	/**< total length offset */
  63:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define CONF_DESC_bConfigurationValue	5	/**< configuration value offset */
  64:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define CONF_DESC_bmAttributes			7	/**< configuration characteristics */
  65:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  66:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /* interface descriptor field offsets */
  67:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define INTF_DESC_bAlternateSetting		3	/**< alternate setting offset */
  68:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  69:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /* endpoint descriptor field offsets */
  70:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define ENDP_DESC_bEndpointAddress		2	/**< endpoint address offset */
  71:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** #define ENDP_DESC_wMaxPacketSize		4	/**< maximum packet size offset */
  72:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  73:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  74:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /** Currently selected configuration */
  75:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static U8				bConfiguration = 0;
  76:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /** Installed custom request handler */
  77:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static TFnHandleRequest	*pfnHandleCustomReq = NULL;
  78:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /** Pointer to registered descriptors */
  79:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static const U8			*pabDescrip = NULL;
  80:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  81:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  82:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
  83:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Registers a pointer to a descriptor block containing all descriptors
  84:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	for the device.
  85:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  86:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]	pabDescriptors	The descriptor byte array
  87:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
  88:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** void USBRegisterDescriptors(const U8 *pabDescriptors)
  89:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
  36              		.loc 1 89 0
  37              		.cfi_startproc
  38              		@ args = 0, pretend = 0, frame = 8
  39              		@ frame_needed = 1, uses_anonymous_args = 0
  40              		@ link register save eliminated.
  41 0000 80B4     		push	{r7}
  42              	.LCFI0:
  43              		.cfi_def_cfa_offset 4
  44              		.cfi_offset 7, -4
  45 0002 83B0     		sub	sp, sp, #12
  46              	.LCFI1:
  47              		.cfi_def_cfa_offset 16
  48 0004 00AF     		add	r7, sp, #0
  49              	.LCFI2:
  50              		.cfi_def_cfa_register 7
  51 0006 7860     		str	r0, [r7, #4]
  90:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	pabDescrip = pabDescriptors;
  52              		.loc 1 90 0
  53 0008 40F20003 		movw	r3, #:lower16:pabDescrip
  54 000c C0F20003 		movt	r3, #:upper16:pabDescrip
  55 0010 7A68     		ldr	r2, [r7, #4]
  56 0012 1A60     		str	r2, [r3, #0]
  91:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
  57              		.loc 1 91 0
  58 0014 07F10C07 		add	r7, r7, #12
  59 0018 BD46     		mov	sp, r7
  60 001a 80BC     		pop	{r7}
  61 001c 7047     		bx	lr
  62              		.cfi_endproc
  63              	.LFE0:
  65 001e 00BF     		.align	2
  66              		.global	USBGetDescriptor
  67              		.thumb
  68              		.thumb_func
  70              	USBGetDescriptor:
  71              	.LFB1:
  92:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  93:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  94:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
  95:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Parses the list of installed USB descriptors and attempts to find
  96:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	the specified USB descriptor.
  97:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
  98:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		wTypeIndex	Type and index of the descriptor
  99:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		wLangID		Language ID of the descriptor (currently unused)
 100:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [out]	*piLen		Descriptor length
 101:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [out]	*ppbData	Descriptor data
 102:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 103:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if the descriptor was found, FALSE otherwise
 104:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 105:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** BOOL USBGetDescriptor(U16 wTypeIndex, U16 wLangID, int *piLen, U8 **ppbData)
 106:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
  72              		.loc 1 106 0
  73              		.cfi_startproc
  74              		@ args = 0, pretend = 0, frame = 32
  75              		@ frame_needed = 1, uses_anonymous_args = 0
  76              		@ link register save eliminated.
  77 0020 80B4     		push	{r7}
  78              	.LCFI3:
  79              		.cfi_def_cfa_offset 4
  80              		.cfi_offset 7, -4
  81 0022 89B0     		sub	sp, sp, #36
  82              	.LCFI4:
  83              		.cfi_def_cfa_offset 40
  84 0024 00AF     		add	r7, sp, #0
  85              	.LCFI5:
  86              		.cfi_def_cfa_register 7
  87 0026 BA60     		str	r2, [r7, #8]
  88 0028 7B60     		str	r3, [r7, #4]
  89 002a 0346     		mov	r3, r0	@ movhi
  90 002c FB81     		strh	r3, [r7, #14]	@ movhi
  91 002e 0B46     		mov	r3, r1	@ movhi
  92 0030 BB81     		strh	r3, [r7, #12]	@ movhi
 107:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	bType, bIndex;
 108:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	*pab;
 109:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	int iCurIndex;
 110:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 111:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	ASSERT(pabDescrip != NULL);
 112:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 113:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	bType = GET_DESC_TYPE(wTypeIndex);
  93              		.loc 1 113 0
  94 0032 FB89     		ldrh	r3, [r7, #14]
  95 0034 4FEA1323 		lsr	r3, r3, #8
  96 0038 9BB2     		uxth	r3, r3
  97 003a FB75     		strb	r3, [r7, #23]
 114:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	bIndex = GET_DESC_INDEX(wTypeIndex);
  98              		.loc 1 114 0
  99 003c FB89     		ldrh	r3, [r7, #14]	@ movhi
 100 003e BB75     		strb	r3, [r7, #22]
 115:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 116:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	pab = (U8 *)pabDescrip;
 101              		.loc 1 116 0
 102 0040 40F20003 		movw	r3, #:lower16:pabDescrip
 103 0044 C0F20003 		movt	r3, #:upper16:pabDescrip
 104 0048 1B68     		ldr	r3, [r3, #0]
 105 004a FB61     		str	r3, [r7, #28]
 117:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	iCurIndex = 0;
 106              		.loc 1 117 0
 107 004c 4FF00003 		mov	r3, #0
 108 0050 BB61     		str	r3, [r7, #24]
 118:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 119:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	while (pab[DESC_bLength] != 0) {
 109              		.loc 1 119 0
 110 0052 30E0     		b	.L3
 111              	.L9:
 120:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pab[DESC_bDescriptorType] == bType) {
 112              		.loc 1 120 0
 113 0054 FB69     		ldr	r3, [r7, #28]
 114 0056 03F10103 		add	r3, r3, #1
 115 005a 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 116 005c FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 117 005e 9A42     		cmp	r2, r3
 118 0060 24D1     		bne	.L4
 121:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			if (iCurIndex == bIndex) {
 119              		.loc 1 121 0
 120 0062 BA7D     		ldrb	r2, [r7, #22]	@ zero_extendqisi2
 121 0064 BB69     		ldr	r3, [r7, #24]
 122 0066 9A42     		cmp	r2, r3
 123 0068 1CD1     		bne	.L5
 122:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				/* set data pointer */
 123:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				*ppbData = pab;
 124              		.loc 1 123 0
 125 006a 7B68     		ldr	r3, [r7, #4]
 126 006c FA69     		ldr	r2, [r7, #28]
 127 006e 1A60     		str	r2, [r3, #0]
 124:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				/* get length from structure */
 125:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				if (bType == DESC_CONFIGURATION) {
 128              		.loc 1 125 0
 129 0070 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 130 0072 022B     		cmp	r3, #2
 131 0074 0ED1     		bne	.L6
 126:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					/* configuration descriptor is an exception, length is at offset 2 and 3 */
 127:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					*piLen =	(pab[CONF_DESC_wTotalLength]) |
 132              		.loc 1 127 0
 133 0076 FB69     		ldr	r3, [r7, #28]
 134 0078 03F10203 		add	r3, r3, #2
 135 007c 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 136 007e 1A46     		mov	r2, r3
 128:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 								(pab[CONF_DESC_wTotalLength + 1] << 8);
 137              		.loc 1 128 0
 138 0080 FB69     		ldr	r3, [r7, #28]
 139 0082 03F10303 		add	r3, r3, #3
 140 0086 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 141 0088 4FEA0323 		lsl	r3, r3, #8
 127:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					*piLen =	(pab[CONF_DESC_wTotalLength]) |
 142              		.loc 1 127 0
 143 008c 1A43     		orrs	r2, r2, r3
 144 008e BB68     		ldr	r3, [r7, #8]
 145 0090 1A60     		str	r2, [r3, #0]
 146 0092 04E0     		b	.L7
 147              	.L6:
 129:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				}
 130:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				else {
 131:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					/* normally length is at offset 0 */
 132:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					*piLen = pab[DESC_bLength];
 148              		.loc 1 132 0
 149 0094 FB69     		ldr	r3, [r7, #28]
 150 0096 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 151 0098 1A46     		mov	r2, r3
 152 009a BB68     		ldr	r3, [r7, #8]
 153 009c 1A60     		str	r2, [r3, #0]
 154              	.L7:
 133:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				}
 134:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				return TRUE;
 155              		.loc 1 134 0
 156 009e 4FF00103 		mov	r3, #1
 157 00a2 0EE0     		b	.L8
 158              	.L5:
 135:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			}
 136:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			iCurIndex++;
 159              		.loc 1 136 0
 160 00a4 BB69     		ldr	r3, [r7, #24]
 161 00a6 03F10103 		add	r3, r3, #1
 162 00aa BB61     		str	r3, [r7, #24]
 163              	.L4:
 137:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 138:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* skip to next descriptor */
 139:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pab += pab[DESC_bLength];
 164              		.loc 1 139 0
 165 00ac FB69     		ldr	r3, [r7, #28]
 166 00ae 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 167 00b0 FA69     		ldr	r2, [r7, #28]
 168 00b2 D318     		adds	r3, r2, r3
 169 00b4 FB61     		str	r3, [r7, #28]
 170              	.L3:
 119:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	while (pab[DESC_bLength] != 0) {
 171              		.loc 1 119 0 discriminator 1
 172 00b6 FB69     		ldr	r3, [r7, #28]
 173 00b8 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 174 00ba 002B     		cmp	r3, #0
 175 00bc CAD1     		bne	.L9
 140:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 141:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	/* nothing found */
 142:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	DBG("Desc %x not found!\n", wTypeIndex);
 143:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	return FALSE;
 176              		.loc 1 143 0
 177 00be 4FF00003 		mov	r3, #0
 178              	.L8:
 144:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 179              		.loc 1 144 0
 180 00c2 1846     		mov	r0, r3
 181 00c4 07F12407 		add	r7, r7, #36
 182 00c8 BD46     		mov	sp, r7
 183 00ca 80BC     		pop	{r7}
 184 00cc 7047     		bx	lr
 185              		.cfi_endproc
 186              	.LFE1:
 188 00ce 00BF     		.align	2
 189              		.thumb
 190              		.thumb_func
 192              	USBSetConfiguration:
 193              	.LFB2:
 145:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 146:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 147:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 148:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Configures the device according to the specified configuration index and
 149:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	alternate setting by parsing the installed USB descriptor list.
 150:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	A configuration index of 0 unconfigures the device.
 151:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 152:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		bConfigIndex	Configuration index
 153:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		bAltSetting		Alternate setting number
 154:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 155:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@todo function always returns TRUE, add stricter checking?
 156:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 157:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if successfully configured, FALSE otherwise
 158:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 159:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static BOOL USBSetConfiguration(U8 bConfigIndex, U8 bAltSetting)
 160:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 194              		.loc 1 160 0
 195              		.cfi_startproc
 196              		@ args = 0, pretend = 0, frame = 24
 197              		@ frame_needed = 1, uses_anonymous_args = 0
 198 00d0 80B5     		push	{r7, lr}
 199              	.LCFI6:
 200              		.cfi_def_cfa_offset 8
 201              		.cfi_offset 14, -4
 202              		.cfi_offset 7, -8
 203 00d2 86B0     		sub	sp, sp, #24
 204              	.LCFI7:
 205              		.cfi_def_cfa_offset 32
 206 00d4 00AF     		add	r7, sp, #0
 207              	.LCFI8:
 208              		.cfi_def_cfa_register 7
 209 00d6 0246     		mov	r2, r0
 210 00d8 0B46     		mov	r3, r1
 211 00da FA71     		strb	r2, [r7, #7]
 212 00dc BB71     		strb	r3, [r7, #6]
 161:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	*pab;
 162:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	bCurConfig, bCurAltSetting;
 163:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	bEP;
 164:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U16	wMaxPktSize;
 165:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 166:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	ASSERT(pabDescrip != NULL);
 167:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 168:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	if (bConfigIndex == 0) {
 213              		.loc 1 168 0
 214 00de FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 215 00e0 002B     		cmp	r3, #0
 216 00e2 04D1     		bne	.L11
 169:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* unconfigure device */
 170:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		USBHwConfigDevice(FALSE);
 217              		.loc 1 170 0
 218 00e4 4FF00000 		mov	r0, #0
 219 00e8 FFF7FEFF 		bl	USBHwConfigDevice
 220 00ec 4EE0     		b	.L12
 221              	.L11:
 171:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 172:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	else {
 173:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* configure endpoints for this configuration/altsetting */
 174:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pab = (U8 *)pabDescrip;
 222              		.loc 1 174 0
 223 00ee 40F20003 		movw	r3, #:lower16:pabDescrip
 224 00f2 C0F20003 		movt	r3, #:upper16:pabDescrip
 225 00f6 1B68     		ldr	r3, [r3, #0]
 226 00f8 7B61     		str	r3, [r7, #20]
 175:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		bCurConfig = 0xFF;
 227              		.loc 1 175 0
 228 00fa 4FF0FF03 		mov	r3, #255
 229 00fe FB74     		strb	r3, [r7, #19]
 176:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		bCurAltSetting = 0xFF;
 230              		.loc 1 176 0
 231 0100 4FF0FF03 		mov	r3, #255
 232 0104 BB74     		strb	r3, [r7, #18]
 177:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 178:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		while (pab[DESC_bLength] != 0) {
 233              		.loc 1 178 0
 234 0106 39E0     		b	.L13
 235              	.L20:
 179:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 180:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			switch (pab[DESC_bDescriptorType]) {
 236              		.loc 1 180 0
 237 0108 7B69     		ldr	r3, [r7, #20]
 238 010a 03F10103 		add	r3, r3, #1
 239 010e 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 240 0110 042B     		cmp	r3, #4
 241 0112 07D0     		beq	.L16
 242 0114 052B     		cmp	r3, #5
 243 0116 09D0     		beq	.L17
 244 0118 022B     		cmp	r3, #2
 245 011a 28D1     		bne	.L21
 246              	.L15:
 181:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 182:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			case DESC_CONFIGURATION:
 183:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				/* remember current configuration index */
 184:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				bCurConfig = pab[CONF_DESC_bConfigurationValue];
 247              		.loc 1 184 0
 248 011c 7B69     		ldr	r3, [r7, #20]
 249 011e 5B79     		ldrb	r3, [r3, #5]
 250 0120 FB74     		strb	r3, [r7, #19]
 185:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				break;
 251              		.loc 1 185 0
 252 0122 26E0     		b	.L18
 253              	.L16:
 186:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 187:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			case DESC_INTERFACE:
 188:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				/* remember current alternate setting */
 189:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				bCurAltSetting = pab[INTF_DESC_bAlternateSetting];
 254              		.loc 1 189 0
 255 0124 7B69     		ldr	r3, [r7, #20]
 256 0126 DB78     		ldrb	r3, [r3, #3]
 257 0128 BB74     		strb	r3, [r7, #18]
 190:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				break;
 258              		.loc 1 190 0
 259 012a 22E0     		b	.L18
 260              	.L17:
 191:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 192:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			case DESC_ENDPOINT:
 193:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				if ((bCurConfig == bConfigIndex) &&
 261              		.loc 1 193 0
 262 012c FA7C     		ldrb	r2, [r7, #19]	@ zero_extendqisi2
 263 012e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 264 0130 9A42     		cmp	r2, r3
 265 0132 1DD1     		bne	.L22
 266              		.loc 1 193 0 is_stmt 0 discriminator 1
 267 0134 BA7C     		ldrb	r2, [r7, #18]	@ zero_extendqisi2
 268 0136 BB79     		ldrb	r3, [r7, #6]	@ zero_extendqisi2
 269 0138 9A42     		cmp	r2, r3
 270 013a 19D1     		bne	.L22
 194:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					(bCurAltSetting == bAltSetting)) {
 195:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					/* endpoint found for desired config and alternate setting */
 196:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					bEP = pab[ENDP_DESC_bEndpointAddress];
 271              		.loc 1 196 0 is_stmt 1
 272 013c 7B69     		ldr	r3, [r7, #20]
 273 013e 9B78     		ldrb	r3, [r3, #2]
 274 0140 7B74     		strb	r3, [r7, #17]
 197:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					wMaxPktSize = 	(pab[ENDP_DESC_wMaxPacketSize]) |
 275              		.loc 1 197 0
 276 0142 7B69     		ldr	r3, [r7, #20]
 277 0144 03F10403 		add	r3, r3, #4
 278 0148 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 279 014a 1A46     		mov	r2, r3
 198:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 									(pab[ENDP_DESC_wMaxPacketSize + 1] << 8);
 280              		.loc 1 198 0
 281 014c 7B69     		ldr	r3, [r7, #20]
 282 014e 03F10503 		add	r3, r3, #5
 283 0152 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 284 0154 4FEA0323 		lsl	r3, r3, #8
 197:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					wMaxPktSize = 	(pab[ENDP_DESC_wMaxPacketSize]) |
 285              		.loc 1 197 0
 286 0158 9BB2     		uxth	r3, r3
 287 015a 1343     		orrs	r3, r3, r2
 288 015c 9BB2     		uxth	r3, r3
 289 015e FB81     		strh	r3, [r7, #14]	@ movhi
 199:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					/* configure endpoint */
 200:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 					USBHwEPConfig(bEP, wMaxPktSize);
 290              		.loc 1 200 0
 291 0160 7A7C     		ldrb	r2, [r7, #17]	@ zero_extendqisi2
 292 0162 FB89     		ldrh	r3, [r7, #14]
 293 0164 1046     		mov	r0, r2
 294 0166 1946     		mov	r1, r3
 295 0168 FFF7FEFF 		bl	USBHwEPConfig
 201:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				}
 202:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				break;
 296              		.loc 1 202 0
 297 016c 00E0     		b	.L22
 298              	.L21:
 203:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 204:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			default:
 205:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				break;
 299              		.loc 1 205 0
 300 016e 00E0     		b	.L18
 301              	.L22:
 202:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 				break;
 302              		.loc 1 202 0
 303 0170 00BF     		nop
 304              	.L18:
 206:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			}
 207:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			/* skip to next descriptor */
 208:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			pab += pab[DESC_bLength];
 305              		.loc 1 208 0
 306 0172 7B69     		ldr	r3, [r7, #20]
 307 0174 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 308 0176 7A69     		ldr	r2, [r7, #20]
 309 0178 D318     		adds	r3, r2, r3
 310 017a 7B61     		str	r3, [r7, #20]
 311              	.L13:
 178:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		while (pab[DESC_bLength] != 0) {
 312              		.loc 1 178 0 discriminator 1
 313 017c 7B69     		ldr	r3, [r7, #20]
 314 017e 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 315 0180 002B     		cmp	r3, #0
 316 0182 C1D1     		bne	.L20
 209:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 210:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 211:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* configure device */
 212:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		USBHwConfigDevice(TRUE);
 317              		.loc 1 212 0
 318 0184 4FF00100 		mov	r0, #1
 319 0188 FFF7FEFF 		bl	USBHwConfigDevice
 320              	.L12:
 213:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 214:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 215:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	return TRUE;
 321              		.loc 1 215 0
 322 018c 4FF00103 		mov	r3, #1
 216:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 323              		.loc 1 216 0
 324 0190 1846     		mov	r0, r3
 325 0192 07F11807 		add	r7, r7, #24
 326 0196 BD46     		mov	sp, r7
 327 0198 80BD     		pop	{r7, pc}
 328              		.cfi_endproc
 329              	.LFE2:
 331 019a 00BF     		.align	2
 332              		.thumb
 333              		.thumb_func
 335              	HandleStdDeviceReq:
 336              	.LFB3:
 217:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 218:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 219:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 220:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Local function to handle a standard device request
 221:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 222:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		pSetup		The setup packet
 223:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in,out]	*piLen		Pointer to data length
 224:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in,out]	ppbData		Data buffer.
 225:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 226:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if the request was handled successfully
 227:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 228:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static BOOL HandleStdDeviceReq(TSetupPacket *pSetup, int *piLen, U8 **ppbData)
 229:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 337              		.loc 1 229 0
 338              		.cfi_startproc
 339              		@ args = 0, pretend = 0, frame = 24
 340              		@ frame_needed = 1, uses_anonymous_args = 0
 341 019c 80B5     		push	{r7, lr}
 342              	.LCFI9:
 343              		.cfi_def_cfa_offset 8
 344              		.cfi_offset 14, -4
 345              		.cfi_offset 7, -8
 346 019e 86B0     		sub	sp, sp, #24
 347              	.LCFI10:
 348              		.cfi_def_cfa_offset 32
 349 01a0 00AF     		add	r7, sp, #0
 350              	.LCFI11:
 351              		.cfi_def_cfa_register 7
 352 01a2 F860     		str	r0, [r7, #12]
 353 01a4 B960     		str	r1, [r7, #8]
 354 01a6 7A60     		str	r2, [r7, #4]
 230:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	*pbData = *ppbData;
 355              		.loc 1 230 0
 356 01a8 7B68     		ldr	r3, [r7, #4]
 357 01aa 1B68     		ldr	r3, [r3, #0]
 358 01ac 7B61     		str	r3, [r7, #20]
 231:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 232:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	switch (pSetup->bRequest) {
 359              		.loc 1 232 0
 360 01ae FB68     		ldr	r3, [r7, #12]
 361 01b0 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 362 01b2 092B     		cmp	r3, #9
 363 01b4 61D8     		bhi	.L24
 364 01b6 01A2     		adr	r2, .L32
 365 01b8 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 366              		.align	2
 367              	.L32:
 368 01bc E5010000 		.word	.L25+1
 369 01c0 6F020000 		.word	.L26+1
 370 01c4 7B020000 		.word	.L24+1
 371 01c8 6F020000 		.word	.L26+1
 372 01cc 7B020000 		.word	.L24+1
 373 01d0 03020000 		.word	.L27+1
 374 01d4 11020000 		.word	.L28+1
 375 01d8 75020000 		.word	.L29+1
 376 01dc 29020000 		.word	.L30+1
 377 01e0 41020000 		.word	.L31+1
 378              	.L25:
 233:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 234:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_STATUS:
 235:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* bit 0: self-powered */
 236:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* bit 1: remote wakeup = not supported */
 237:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[0] = 0;
 379              		.loc 1 237 0
 380 01e4 7B69     		ldr	r3, [r7, #20]
 381 01e6 4FF00002 		mov	r2, #0
 382 01ea 1A70     		strb	r2, [r3, #0]
 238:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[1] = 0;
 383              		.loc 1 238 0
 384 01ec 7B69     		ldr	r3, [r7, #20]
 385 01ee 03F10103 		add	r3, r3, #1
 386 01f2 4FF00002 		mov	r2, #0
 387 01f6 1A70     		strb	r2, [r3, #0]
 239:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 2;
 388              		.loc 1 239 0
 389 01f8 BB68     		ldr	r3, [r7, #8]
 390 01fa 4FF00202 		mov	r2, #2
 391 01fe 1A60     		str	r2, [r3, #0]
 240:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 392              		.loc 1 240 0
 393 0200 3EE0     		b	.L33
 394              	.L27:
 241:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 242:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_ADDRESS:
 243:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		USBHwSetAddress(pSetup->wValue);
 395              		.loc 1 243 0
 396 0202 FB68     		ldr	r3, [r7, #12]
 397 0204 5B88     		ldrh	r3, [r3, #2]
 398 0206 DBB2     		uxtb	r3, r3
 399 0208 1846     		mov	r0, r3
 400 020a FFF7FEFF 		bl	USBHwSetAddress
 244:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 401              		.loc 1 244 0
 402 020e 37E0     		b	.L33
 403              	.L28:
 245:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 246:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_DESCRIPTOR:
 247:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("D%x", pSetup->wValue);
 248:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return USBGetDescriptor(pSetup->wValue, pSetup->wIndex, piLen, ppbData);
 404              		.loc 1 248 0
 405 0210 FB68     		ldr	r3, [r7, #12]
 406 0212 5A88     		ldrh	r2, [r3, #2]
 407 0214 FB68     		ldr	r3, [r7, #12]
 408 0216 9B88     		ldrh	r3, [r3, #4]
 409 0218 1046     		mov	r0, r2
 410 021a 1946     		mov	r1, r3
 411 021c BA68     		ldr	r2, [r7, #8]
 412 021e 7B68     		ldr	r3, [r7, #4]
 413 0220 FFF7FEFF 		bl	USBGetDescriptor
 414 0224 0346     		mov	r3, r0
 415 0226 2DE0     		b	.L34
 416              	.L30:
 249:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 250:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_CONFIGURATION:
 251:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* indicate if we are configured */
 252:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[0] = bConfiguration;
 417              		.loc 1 252 0
 418 0228 40F20003 		movw	r3, #:lower16:bConfiguration
 419 022c C0F20003 		movt	r3, #:upper16:bConfiguration
 420 0230 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 421 0232 7B69     		ldr	r3, [r7, #20]
 422 0234 1A70     		strb	r2, [r3, #0]
 253:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 1;
 423              		.loc 1 253 0
 424 0236 BB68     		ldr	r3, [r7, #8]
 425 0238 4FF00102 		mov	r2, #1
 426 023c 1A60     		str	r2, [r3, #0]
 254:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 427              		.loc 1 254 0
 428 023e 1FE0     		b	.L33
 429              	.L31:
 255:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 256:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_CONFIGURATION:
 257:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (!USBSetConfiguration(pSetup->wValue & 0xFF, 0)) {
 430              		.loc 1 257 0
 431 0240 FB68     		ldr	r3, [r7, #12]
 432 0242 5B88     		ldrh	r3, [r3, #2]
 433 0244 DBB2     		uxtb	r3, r3
 434 0246 1846     		mov	r0, r3
 435 0248 4FF00001 		mov	r1, #0
 436 024c FFF740FF 		bl	USBSetConfiguration
 437 0250 0346     		mov	r3, r0
 438 0252 002B     		cmp	r3, #0
 439 0254 02D1     		bne	.L35
 258:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			DBG("USBSetConfiguration failed!\n");
 259:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			return FALSE;
 440              		.loc 1 259 0
 441 0256 4FF00003 		mov	r3, #0
 442 025a 13E0     		b	.L34
 443              	.L35:
 260:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 261:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* configuration successful, update current configuration */
 262:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		bConfiguration = pSetup->wValue & 0xFF;
 444              		.loc 1 262 0
 445 025c FB68     		ldr	r3, [r7, #12]
 446 025e 5B88     		ldrh	r3, [r3, #2]
 447 0260 DAB2     		uxtb	r2, r3
 448 0262 40F20003 		movw	r3, #:lower16:bConfiguration
 449 0266 C0F20003 		movt	r3, #:upper16:bConfiguration
 450 026a 1A70     		strb	r2, [r3, #0]
 263:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 451              		.loc 1 263 0
 452 026c 08E0     		b	.L33
 453              	.L26:
 264:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 265:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_CLEAR_FEATURE:
 266:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_FEATURE:
 267:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pSetup->wValue == FEA_REMOTE_WAKEUP) {
 268:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			/* put DEVICE_REMOTE_WAKEUP code here */
 269:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 270:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pSetup->wValue == FEA_TEST_MODE) {
 271:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			/* put TEST_MODE code here */
 272:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 273:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 454              		.loc 1 273 0
 455 026e 4FF00003 		mov	r3, #0
 456 0272 07E0     		b	.L34
 457              	.L29:
 274:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 275:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_DESCRIPTOR:
 276:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("Device req %d not implemented\n", pSetup->bRequest);
 277:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 458              		.loc 1 277 0
 459 0274 4FF00003 		mov	r3, #0
 460 0278 04E0     		b	.L34
 461              	.L24:
 278:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 279:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	default:
 280:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("Illegal device req %d\n", pSetup->bRequest);
 281:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 462              		.loc 1 281 0
 463 027a 4FF00003 		mov	r3, #0
 464 027e 01E0     		b	.L34
 465              	.L33:
 282:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 283:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 284:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	return TRUE;
 466              		.loc 1 284 0
 467 0280 4FF00103 		mov	r3, #1
 468              	.L34:
 285:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 469              		.loc 1 285 0
 470 0284 1846     		mov	r0, r3
 471 0286 07F11807 		add	r7, r7, #24
 472 028a BD46     		mov	sp, r7
 473 028c 80BD     		pop	{r7, pc}
 474              		.cfi_endproc
 475              	.LFE3:
 477 028e 00BF     		.align	2
 478              		.thumb
 479              		.thumb_func
 481              	HandleStdInterfaceReq:
 482              	.LFB4:
 286:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 287:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 288:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 289:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Local function to handle a standard interface request
 290:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 291:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		pSetup		The setup packet
 292:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in,out]	*piLen		Pointer to data length
 293:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		ppbData		Data buffer.
 294:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 295:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if the request was handled successfully
 296:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 297:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static BOOL HandleStdInterfaceReq(TSetupPacket	*pSetup, int *piLen, U8 **ppbData)
 298:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 483              		.loc 1 298 0
 484              		.cfi_startproc
 485              		@ args = 0, pretend = 0, frame = 24
 486              		@ frame_needed = 1, uses_anonymous_args = 0
 487              		@ link register save eliminated.
 488 0290 80B4     		push	{r7}
 489              	.LCFI12:
 490              		.cfi_def_cfa_offset 4
 491              		.cfi_offset 7, -4
 492 0292 87B0     		sub	sp, sp, #28
 493              	.LCFI13:
 494              		.cfi_def_cfa_offset 32
 495 0294 00AF     		add	r7, sp, #0
 496              	.LCFI14:
 497              		.cfi_def_cfa_register 7
 498 0296 F860     		str	r0, [r7, #12]
 499 0298 B960     		str	r1, [r7, #8]
 500 029a 7A60     		str	r2, [r7, #4]
 299:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	*pbData = *ppbData;
 501              		.loc 1 299 0
 502 029c 7B68     		ldr	r3, [r7, #4]
 503 029e 1B68     		ldr	r3, [r3, #0]
 504 02a0 7B61     		str	r3, [r7, #20]
 300:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 301:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	switch (pSetup->bRequest) {
 505              		.loc 1 301 0
 506 02a2 FB68     		ldr	r3, [r7, #12]
 507 02a4 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 508 02a6 0B2B     		cmp	r3, #11
 509 02a8 41D8     		bhi	.L37
 510 02aa 01A2     		adr	r2, .L42
 511 02ac 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 512              		.align	2
 513              	.L42:
 514 02b0 E1020000 		.word	.L38+1
 515 02b4 FF020000 		.word	.L39+1
 516 02b8 2F030000 		.word	.L37+1
 517 02bc FF020000 		.word	.L39+1
 518 02c0 2F030000 		.word	.L37+1
 519 02c4 2F030000 		.word	.L37+1
 520 02c8 2F030000 		.word	.L37+1
 521 02cc 2F030000 		.word	.L37+1
 522 02d0 2F030000 		.word	.L37+1
 523 02d4 2F030000 		.word	.L37+1
 524 02d8 05030000 		.word	.L40+1
 525 02dc 17030000 		.word	.L41+1
 526              	.L38:
 302:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 303:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_STATUS:
 304:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* no bits specified */
 305:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[0] = 0;
 527              		.loc 1 305 0
 528 02e0 7B69     		ldr	r3, [r7, #20]
 529 02e2 4FF00002 		mov	r2, #0
 530 02e6 1A70     		strb	r2, [r3, #0]
 306:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[1] = 0;
 531              		.loc 1 306 0
 532 02e8 7B69     		ldr	r3, [r7, #20]
 533 02ea 03F10103 		add	r3, r3, #1
 534 02ee 4FF00002 		mov	r2, #0
 535 02f2 1A70     		strb	r2, [r3, #0]
 307:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 2;
 536              		.loc 1 307 0
 537 02f4 BB68     		ldr	r3, [r7, #8]
 538 02f6 4FF00202 		mov	r2, #2
 539 02fa 1A60     		str	r2, [r3, #0]
 308:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 540              		.loc 1 308 0
 541 02fc 1AE0     		b	.L43
 542              	.L39:
 309:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 310:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_CLEAR_FEATURE:
 311:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_FEATURE:
 312:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* not defined for interface */
 313:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 543              		.loc 1 313 0
 544 02fe 4FF00003 		mov	r3, #0
 545 0302 19E0     		b	.L44
 546              	.L40:
 314:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 315:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_INTERFACE:	/* TODO use bNumInterfaces */
 316:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****         /* there is only one interface, return n-1 (= 0) */
 317:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[0] = 0;
 547              		.loc 1 317 0
 548 0304 7B69     		ldr	r3, [r7, #20]
 549 0306 4FF00002 		mov	r2, #0
 550 030a 1A70     		strb	r2, [r3, #0]
 318:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 1;
 551              		.loc 1 318 0
 552 030c BB68     		ldr	r3, [r7, #8]
 553 030e 4FF00102 		mov	r2, #1
 554 0312 1A60     		str	r2, [r3, #0]
 319:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 555              		.loc 1 319 0
 556 0314 0EE0     		b	.L43
 557              	.L41:
 320:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 321:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_INTERFACE:	/* TODO use bNumInterfaces */
 322:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* there is only one interface (= 0) */
 323:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pSetup->wValue != 0) {
 558              		.loc 1 323 0
 559 0316 FB68     		ldr	r3, [r7, #12]
 560 0318 5B88     		ldrh	r3, [r3, #2]
 561 031a 002B     		cmp	r3, #0
 562 031c 02D0     		beq	.L45
 324:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			return FALSE;
 563              		.loc 1 324 0
 564 031e 4FF00003 		mov	r3, #0
 565 0322 09E0     		b	.L44
 566              	.L45:
 325:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 326:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 0;
 567              		.loc 1 326 0
 568 0324 BB68     		ldr	r3, [r7, #8]
 569 0326 4FF00002 		mov	r2, #0
 570 032a 1A60     		str	r2, [r3, #0]
 327:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 571              		.loc 1 327 0
 572 032c 02E0     		b	.L43
 573              	.L37:
 328:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 329:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	default:
 330:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("Illegal interface req %d\n", pSetup->bRequest);
 331:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 574              		.loc 1 331 0
 575 032e 4FF00003 		mov	r3, #0
 576 0332 01E0     		b	.L44
 577              	.L43:
 332:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 333:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 334:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	return TRUE;
 578              		.loc 1 334 0
 579 0334 4FF00103 		mov	r3, #1
 580              	.L44:
 335:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 581              		.loc 1 335 0
 582 0338 1846     		mov	r0, r3
 583 033a 07F11C07 		add	r7, r7, #28
 584 033e BD46     		mov	sp, r7
 585 0340 80BC     		pop	{r7}
 586 0342 7047     		bx	lr
 587              		.cfi_endproc
 588              	.LFE4:
 590              		.align	2
 591              		.thumb
 592              		.thumb_func
 594              	HandleStdEndPointReq:
 595              	.LFB5:
 336:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 337:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 338:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 339:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Local function to handle a standard endpoint request
 340:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 341:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		pSetup		The setup packet
 342:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in,out]	*piLen		Pointer to data length
 343:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		ppbData		Data buffer.
 344:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 345:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if the request was handled successfully
 346:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 347:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** static BOOL HandleStdEndPointReq(TSetupPacket	*pSetup, int *piLen, U8 **ppbData)
 348:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 596              		.loc 1 348 0
 597              		.cfi_startproc
 598              		@ args = 0, pretend = 0, frame = 24
 599              		@ frame_needed = 1, uses_anonymous_args = 0
 600 0344 80B5     		push	{r7, lr}
 601              	.LCFI15:
 602              		.cfi_def_cfa_offset 8
 603              		.cfi_offset 14, -4
 604              		.cfi_offset 7, -8
 605 0346 86B0     		sub	sp, sp, #24
 606              	.LCFI16:
 607              		.cfi_def_cfa_offset 32
 608 0348 00AF     		add	r7, sp, #0
 609              	.LCFI17:
 610              		.cfi_def_cfa_register 7
 611 034a F860     		str	r0, [r7, #12]
 612 034c B960     		str	r1, [r7, #8]
 613 034e 7A60     		str	r2, [r7, #4]
 349:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	U8	*pbData = *ppbData;
 614              		.loc 1 349 0
 615 0350 7B68     		ldr	r3, [r7, #4]
 616 0352 1B68     		ldr	r3, [r3, #0]
 617 0354 7B61     		str	r3, [r7, #20]
 350:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 351:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	switch (pSetup->bRequest) {
 618              		.loc 1 351 0
 619 0356 FB68     		ldr	r3, [r7, #12]
 620 0358 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 621 035a 0C2B     		cmp	r3, #12
 622 035c 5AD8     		bhi	.L47
 623 035e 01A2     		adr	r2, .L52
 624 0360 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 625              		.align	2
 626              	.L52:
 627 0364 99030000 		.word	.L48+1
 628 0368 CF030000 		.word	.L49+1
 629 036c 15040000 		.word	.L47+1
 630 0370 EF030000 		.word	.L50+1
 631 0374 15040000 		.word	.L47+1
 632 0378 15040000 		.word	.L47+1
 633 037c 15040000 		.word	.L47+1
 634 0380 15040000 		.word	.L47+1
 635 0384 15040000 		.word	.L47+1
 636 0388 15040000 		.word	.L47+1
 637 038c 15040000 		.word	.L47+1
 638 0390 15040000 		.word	.L47+1
 639 0394 0F040000 		.word	.L51+1
 640              	.L48:
 352:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_GET_STATUS:
 353:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* bit 0 = endpointed halted or not */
 354:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[0] = (USBHwEPGetStatus(pSetup->wIndex) & EP_STATUS_STALLED) ? 1 : 0;
 641              		.loc 1 354 0
 642 0398 FB68     		ldr	r3, [r7, #12]
 643 039a 9B88     		ldrh	r3, [r3, #4]
 644 039c DBB2     		uxtb	r3, r3
 645 039e 1846     		mov	r0, r3
 646 03a0 FFF7FEFF 		bl	USBHwEPGetStatus
 647 03a4 0346     		mov	r3, r0
 648 03a6 03F00203 		and	r3, r3, #2
 649 03aa 002B     		cmp	r3, #0
 650 03ac 0CBF     		ite	eq
 651 03ae 0023     		moveq	r3, #0
 652 03b0 0123     		movne	r3, #1
 653 03b2 DAB2     		uxtb	r2, r3
 654 03b4 7B69     		ldr	r3, [r7, #20]
 655 03b6 1A70     		strb	r2, [r3, #0]
 355:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		pbData[1] = 0;
 656              		.loc 1 355 0
 657 03b8 7B69     		ldr	r3, [r7, #20]
 658 03ba 03F10103 		add	r3, r3, #1
 659 03be 4FF00002 		mov	r2, #0
 660 03c2 1A70     		strb	r2, [r3, #0]
 356:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		*piLen = 2;
 661              		.loc 1 356 0
 662 03c4 BB68     		ldr	r3, [r7, #8]
 663 03c6 4FF00202 		mov	r2, #2
 664 03ca 1A60     		str	r2, [r3, #0]
 357:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		break;
 665              		.loc 1 357 0
 666 03cc 25E0     		b	.L53
 667              	.L49:
 358:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 359:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_CLEAR_FEATURE:
 360:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pSetup->wValue == FEA_ENDPOINT_HALT) {
 668              		.loc 1 360 0
 669 03ce FB68     		ldr	r3, [r7, #12]
 670 03d0 5B88     		ldrh	r3, [r3, #2]
 671 03d2 002B     		cmp	r3, #0
 672 03d4 08D1     		bne	.L54
 361:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			/* clear HALT by unstalling */
 362:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			USBHwEPStall(pSetup->wIndex, FALSE);
 673              		.loc 1 362 0
 674 03d6 FB68     		ldr	r3, [r7, #12]
 675 03d8 9B88     		ldrh	r3, [r3, #4]
 676 03da DBB2     		uxtb	r3, r3
 677 03dc 1846     		mov	r0, r3
 678 03de 4FF00001 		mov	r1, #0
 679 03e2 FFF7FEFF 		bl	USBHwEPStall
 363:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			break;
 680              		.loc 1 363 0
 681 03e6 18E0     		b	.L53
 682              	.L54:
 364:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 365:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* only ENDPOINT_HALT defined for endpoints */
 366:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 683              		.loc 1 366 0
 684 03e8 4FF00003 		mov	r3, #0
 685 03ec 17E0     		b	.L55
 686              	.L50:
 367:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 368:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SET_FEATURE:
 369:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		if (pSetup->wValue == FEA_ENDPOINT_HALT) {
 687              		.loc 1 369 0
 688 03ee FB68     		ldr	r3, [r7, #12]
 689 03f0 5B88     		ldrh	r3, [r3, #2]
 690 03f2 002B     		cmp	r3, #0
 691 03f4 08D1     		bne	.L56
 370:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			/* set HALT by stalling */
 371:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			USBHwEPStall(pSetup->wIndex, TRUE);
 692              		.loc 1 371 0
 693 03f6 FB68     		ldr	r3, [r7, #12]
 694 03f8 9B88     		ldrh	r3, [r3, #4]
 695 03fa DBB2     		uxtb	r3, r3
 696 03fc 1846     		mov	r0, r3
 697 03fe 4FF00101 		mov	r1, #1
 698 0402 FFF7FEFF 		bl	USBHwEPStall
 372:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 			break;
 699              		.loc 1 372 0
 700 0406 08E0     		b	.L53
 701              	.L56:
 373:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		}
 374:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		/* only ENDPOINT_HALT defined for endpoints */
 375:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 702              		.loc 1 375 0
 703 0408 4FF00003 		mov	r3, #0
 704 040c 07E0     		b	.L55
 705              	.L51:
 376:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 377:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQ_SYNCH_FRAME:
 378:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("EP req %d not implemented\n", pSetup->bRequest);
 379:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 706              		.loc 1 379 0
 707 040e 4FF00003 		mov	r3, #0
 708 0412 04E0     		b	.L55
 709              	.L47:
 380:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 381:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	default:
 382:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		DBG("Illegal EP req %d\n", pSetup->bRequest);
 383:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return FALSE;
 710              		.loc 1 383 0
 711 0414 4FF00003 		mov	r3, #0
 712 0418 01E0     		b	.L55
 713              	.L53:
 384:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 385:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 386:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	return TRUE;
 714              		.loc 1 386 0
 715 041a 4FF00103 		mov	r3, #1
 716              	.L55:
 387:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 717              		.loc 1 387 0
 718 041e 1846     		mov	r0, r3
 719 0420 07F11807 		add	r7, r7, #24
 720 0424 BD46     		mov	sp, r7
 721 0426 80BD     		pop	{r7, pc}
 722              		.cfi_endproc
 723              	.LFE5:
 725              		.align	2
 726              		.global	USBHandleStandardRequest
 727              		.thumb
 728              		.thumb_func
 730              	USBHandleStandardRequest:
 731              	.LFB6:
 388:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 389:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 390:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 391:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Default handler for standard ('chapter 9') requests
 392:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 393:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	If a custom request handler was installed, this handler is called first.
 394:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 395:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		pSetup		The setup packet
 396:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in,out]	*piLen		Pointer to data length
 397:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]		ppbData		Data buffer.
 398:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 399:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@return TRUE if the request was handled successfully
 400:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 401:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** BOOL USBHandleStandardRequest(TSetupPacket	*pSetup, int *piLen, U8 **ppbData)
 402:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 732              		.loc 1 402 0
 733              		.cfi_startproc
 734              		@ args = 0, pretend = 0, frame = 16
 735              		@ frame_needed = 1, uses_anonymous_args = 0
 736 0428 80B5     		push	{r7, lr}
 737              	.LCFI18:
 738              		.cfi_def_cfa_offset 8
 739              		.cfi_offset 14, -4
 740              		.cfi_offset 7, -8
 741 042a 84B0     		sub	sp, sp, #16
 742              	.LCFI19:
 743              		.cfi_def_cfa_offset 24
 744 042c 00AF     		add	r7, sp, #0
 745              	.LCFI20:
 746              		.cfi_def_cfa_register 7
 747 042e F860     		str	r0, [r7, #12]
 748 0430 B960     		str	r1, [r7, #8]
 749 0432 7A60     		str	r2, [r7, #4]
 403:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	/* try the custom request handler first */
 404:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	if ((pfnHandleCustomReq != NULL) && pfnHandleCustomReq(pSetup, piLen, ppbData)) {
 750              		.loc 1 404 0
 751 0434 40F20003 		movw	r3, #:lower16:pfnHandleCustomReq
 752 0438 C0F20003 		movt	r3, #:upper16:pfnHandleCustomReq
 753 043c 1B68     		ldr	r3, [r3, #0]
 754 043e 002B     		cmp	r3, #0
 755 0440 0ED0     		beq	.L58
 756              		.loc 1 404 0 is_stmt 0 discriminator 1
 757 0442 40F20003 		movw	r3, #:lower16:pfnHandleCustomReq
 758 0446 C0F20003 		movt	r3, #:upper16:pfnHandleCustomReq
 759 044a 1B68     		ldr	r3, [r3, #0]
 760 044c F868     		ldr	r0, [r7, #12]
 761 044e B968     		ldr	r1, [r7, #8]
 762 0450 7A68     		ldr	r2, [r7, #4]
 763 0452 9847     		blx	r3
 764 0454 0346     		mov	r3, r0
 765 0456 002B     		cmp	r3, #0
 766 0458 02D0     		beq	.L58
 405:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 		return TRUE;
 767              		.loc 1 405 0 is_stmt 1
 768 045a 4FF00103 		mov	r3, #1
 769 045e 20E0     		b	.L59
 770              	.L58:
 406:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 407:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 408:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	switch (REQTYPE_GET_RECIP(pSetup->bmRequestType)) {
 771              		.loc 1 408 0
 772 0460 FB68     		ldr	r3, [r7, #12]
 773 0462 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 774 0464 03F01F03 		and	r3, r3, #31
 775 0468 012B     		cmp	r3, #1
 776 046a 0AD0     		beq	.L62
 777 046c 022B     		cmp	r3, #2
 778 046e 0FD0     		beq	.L63
 779 0470 002B     		cmp	r3, #0
 780 0472 14D1     		bne	.L64
 781              	.L61:
 409:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQTYPE_RECIP_DEVICE:		return HandleStdDeviceReq(pSetup, piLen, ppbData);
 782              		.loc 1 409 0
 783 0474 F868     		ldr	r0, [r7, #12]
 784 0476 B968     		ldr	r1, [r7, #8]
 785 0478 7A68     		ldr	r2, [r7, #4]
 786 047a FFF78FFE 		bl	HandleStdDeviceReq
 787 047e 0346     		mov	r3, r0
 788 0480 0FE0     		b	.L59
 789              	.L62:
 410:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQTYPE_RECIP_INTERFACE:	return HandleStdInterfaceReq(pSetup, piLen, ppbData);
 790              		.loc 1 410 0
 791 0482 F868     		ldr	r0, [r7, #12]
 792 0484 B968     		ldr	r1, [r7, #8]
 793 0486 7A68     		ldr	r2, [r7, #4]
 794 0488 FFF702FF 		bl	HandleStdInterfaceReq
 795 048c 0346     		mov	r3, r0
 796 048e 08E0     		b	.L59
 797              	.L63:
 411:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	case REQTYPE_RECIP_ENDPOINT: 	return HandleStdEndPointReq(pSetup, piLen, ppbData);
 798              		.loc 1 411 0
 799 0490 F868     		ldr	r0, [r7, #12]
 800 0492 B968     		ldr	r1, [r7, #8]
 801 0494 7A68     		ldr	r2, [r7, #4]
 802 0496 FFF755FF 		bl	HandleStdEndPointReq
 803 049a 0346     		mov	r3, r0
 804 049c 01E0     		b	.L59
 805              	.L64:
 412:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	default: 						return FALSE;
 806              		.loc 1 412 0
 807 049e 4FF00003 		mov	r3, #0
 808              	.L59:
 413:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	}
 414:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 809              		.loc 1 414 0
 810 04a2 1846     		mov	r0, r3
 811 04a4 07F11007 		add	r7, r7, #16
 812 04a8 BD46     		mov	sp, r7
 813 04aa 80BD     		pop	{r7, pc}
 814              		.cfi_endproc
 815              	.LFE6:
 817              		.align	2
 818              		.global	USBRegisterCustomReqHandler
 819              		.thumb
 820              		.thumb_func
 822              	USBRegisterCustomReqHandler:
 823              	.LFB7:
 415:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 416:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** /**
 417:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	Registers a callback for custom device requests
 418:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 419:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	In USBHandleStandardRequest, the custom request handler gets a first
 420:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	chance at handling the request before it is handed over to the 'chapter 9'
 421:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	request handler.
 422:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 423:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	This can be used for example in HID devices, where a REQ_GET_DESCRIPTOR
 424:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	request is sent to an interface, which is not covered by the 'chapter 9'
 425:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	specification.
 426:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 
 427:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	@param [in]	pfnHandler	Callback function pointer
 428:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c ****  */
 429:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** void USBRegisterCustomReqHandler(TFnHandleRequest *pfnHandler)
 430:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** {
 824              		.loc 1 430 0
 825              		.cfi_startproc
 826              		@ args = 0, pretend = 0, frame = 8
 827              		@ frame_needed = 1, uses_anonymous_args = 0
 828              		@ link register save eliminated.
 829 04ac 80B4     		push	{r7}
 830              	.LCFI21:
 831              		.cfi_def_cfa_offset 4
 832              		.cfi_offset 7, -4
 833 04ae 83B0     		sub	sp, sp, #12
 834              	.LCFI22:
 835              		.cfi_def_cfa_offset 16
 836 04b0 00AF     		add	r7, sp, #0
 837              	.LCFI23:
 838              		.cfi_def_cfa_register 7
 839 04b2 7860     		str	r0, [r7, #4]
 431:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** 	pfnHandleCustomReq = pfnHandler;
 840              		.loc 1 431 0
 841 04b4 40F20003 		movw	r3, #:lower16:pfnHandleCustomReq
 842 04b8 C0F20003 		movt	r3, #:upper16:pfnHandleCustomReq
 843 04bc 7A68     		ldr	r2, [r7, #4]
 844 04be 1A60     		str	r2, [r3, #0]
 432:Libraries/uC-CSP/LPC17xx/USB/src/usbstdreq.c **** }
 845              		.loc 1 432 0
 846 04c0 07F10C07 		add	r7, r7, #12
 847 04c4 BD46     		mov	sp, r7
 848 04c6 80BC     		pop	{r7}
 849 04c8 7047     		bx	lr
 850              		.cfi_endproc
 851              	.LFE7:
 853              	.Letext0:
 854              		.file 2 "/home/wimma/bin/codesourcery/Sourcery_CodeBench_Lite_for_ARM_EABI/bin/../lib/gcc/arm-none
 855              		.file 3 "Libraries/CM3/inc/lpc_types.h"
 856              		.file 4 "Libraries/uC-CSP/LPC17xx/USB/inc/usbstruct.h"
 857              		.file 5 "Libraries/uC-CSP/LPC17xx/USB/inc/usbapi.h"
DEFINED SYMBOLS
                            *ABS*:00000000 usbstdreq.c
     /tmp/cc5rWmU5.s:19     .bss:00000000 bConfiguration
     /tmp/cc5rWmU5.s:20     .bss:00000000 $d
     /tmp/cc5rWmU5.s:22     .bss:00000004 pfnHandleCustomReq
     /tmp/cc5rWmU5.s:25     .bss:00000008 pabDescrip
     /tmp/cc5rWmU5.s:28     .text:00000000 $t
     /tmp/cc5rWmU5.s:33     .text:00000000 USBRegisterDescriptors
     /tmp/cc5rWmU5.s:70     .text:00000020 USBGetDescriptor
     /tmp/cc5rWmU5.s:192    .text:000000d0 USBSetConfiguration
     /tmp/cc5rWmU5.s:335    .text:0000019c HandleStdDeviceReq
     /tmp/cc5rWmU5.s:368    .text:000001bc $d
     /tmp/cc5rWmU5.s:380    .text:000001e4 $t
     /tmp/cc5rWmU5.s:481    .text:00000290 HandleStdInterfaceReq
     /tmp/cc5rWmU5.s:514    .text:000002b0 $d
     /tmp/cc5rWmU5.s:528    .text:000002e0 $t
     /tmp/cc5rWmU5.s:594    .text:00000344 HandleStdEndPointReq
     /tmp/cc5rWmU5.s:627    .text:00000364 $d
     /tmp/cc5rWmU5.s:642    .text:00000398 $t
     /tmp/cc5rWmU5.s:730    .text:00000428 USBHandleStandardRequest
     /tmp/cc5rWmU5.s:822    .text:000004ac USBRegisterCustomReqHandler
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
USBHwConfigDevice
USBHwEPConfig
USBHwSetAddress
USBHwEPGetStatus
USBHwEPStall
